@page "/Error"

<PageTitle>Error</PageTitle>

<h1>Error</h1>
<h2>Ha ocurrido un error al procesar tu solicitud.</h2>

@if (ShowDetails)
{
    <details>
        <summary>Mostrar detalles del error</summary>
        <p>@ErrorMessage</p>
    </details>
}

@code {
    [CascadingParameter]
    private HttpContext? HttpContext { get; set; }

    private string ErrorMessage { get; set; } = string.Empty;
    private bool ShowDetails { get; set; }

    protected override void OnInitialized()
    {
        ShowDetails = HttpContext?.RequestServices
            .GetService<IWebHostEnvironment>()
            ?.IsDevelopment() ?? false;

        if (ShowDetails && HttpContext is not null)
        {
            var feature = HttpContext.Features.Get<Microsoft.AspNetCore.Diagnostics.IExceptionHandlerFeature>();
            ErrorMessage = feature?.Error.Message ?? "Error desconocido";
        }
    }
}